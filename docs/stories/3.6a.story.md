# Story 3.6a: Due Date Alert Dashboard Display

## Status
Draft

## Story
**As an Accounts team member,**
**I want dashboard alerts showing overdue accounts,**
**so that I can see which customers require immediate follow-up.**

## Acceptance Criteria
1. Dashboard widget displaying overdue accounts with days overdue
2. Quick action buttons to mark follow-up completed or escalate

## Tasks / Subtasks
- [ ] Create overdue accounts dashboard widget (AC: 1)
  - [ ] Build OverdueAccountsWidget component using shadcn/ui Card and Badge components
  - [ ] Implement real-time overdue calculations based on receivable due dates
  - [ ] Display customer name, invoice number, amount, and days overdue
  - [ ] Add visual indicators for severity levels (7+ days, 30+ days, 60+ days)
  - [ ] Create responsive widget layout that adapts to different screen sizes
- [ ] Implement quick action functionality for overdue accounts (AC: 2)
  - [ ] Add "Mark Follow-up Completed" quick action button
  - [ ] Create "Escalate" action button for management notification
  - [ ] Implement inline follow-up note entry for quick updates
  - [ ] Add "Schedule Follow-up" functionality with date picker
  - [ ] Create bulk action capabilities for multiple overdue accounts
- [ ] Integrate widget with main dashboard layout (AC: 1, 2)
  - [ ] Position overdue accounts widget prominently on Accounts team dashboard
  - [ ] Implement role-based visibility for Accounts and Admin users only
  - [ ] Add refresh functionality with real-time data updates
  - [ ] Create click-through navigation to detailed receivables view
  - [ ] Add loading states and error handling for widget data

## Dev Notes

### Tech Stack Requirements
[Source: architecture/tech-stack.md]
- UI Component Library: shadcn/ui v4 with Card, Badge, Button, and DataTable components
- Frontend Language: TypeScript 5.0+ for type-safe development
- State Management: Zustand 4.4+ for dashboard state and real-time updates

### Frontend Architecture Requirements
[Source: architecture/frontend-architecture.md]
- Component Organization: Dashboard widgets in src/components/business/dashboard/
- State Management: Global state using Zustand for dashboard data
- Component Architecture: Widget-based dashboard design with modular components

### Database Query Requirements
Building on existing receivables data model for overdue calculations:
```sql
-- Query for overdue accounts with calculated days overdue
SELECT
  r.id,
  r.invoice_number,
  r.amount,
  r.due_date,
  c.name as customer_name,
  c.email as customer_email,
  EXTRACT(DAY FROM NOW() - r.due_date) as days_overdue,
  r.status
FROM receivables r
JOIN customers c ON r.customer_id = c.id
WHERE r.status IN ('PENDING', 'PARTIALLY_PAID', 'OVERDUE')
  AND r.due_date < NOW()
  AND c.is_active = true
ORDER BY days_overdue DESC, r.amount DESC;
```

### Data Model Requirements
[Source: architecture/data-models.md]
Utilizing existing Receivable and Customer models:
```typescript
interface OverdueAccount {
  id: string;
  invoiceNumber: string;
  amount: Decimal;
  dueDate: Date;
  daysOverdue: number;
  status: ReceivableStatus;
  customer: {
    id: string;
    name: string;
    email: string;
  };
}

interface DashboardWidget {
  id: string;
  title: string;
  priority: number;
  refreshInterval: number;
  roleAccess: UserRole[];
}
```

### Dashboard Integration
Building on existing dashboard framework from Story 1.3:
- Widget-based dashboard layout with role-specific content
- Real-time data updates for critical financial information
- Responsive design for desktop and mobile access

### Coding Standards
[Source: architecture/coding-standards.md]
- Components: Use PascalCase naming (OverdueAccountsWidget.tsx, QuickActionButton.tsx)
- State Updates: Never mutate state directly - use proper Zustand patterns
- API Calls: Never make direct HTTP calls - use the service layer

### File Locations
- Dashboard widget: `src/components/business/dashboard/OverdueAccountsWidget.tsx`
- Quick actions: `src/components/business/dashboard/QuickActionButtons.tsx`
- Dashboard service: `src/services/dashboardService.ts`
- Overdue API: `app/api/dashboard/overdue-accounts/route.ts`
- Types: `types/dashboard.ts`
- Widget store: `src/stores/dashboardStore.ts`

### Testing Requirements
[Source: architecture/testing-strategy.md]
- Frontend Testing: Jest + Testing Library for widget interaction testing
- Backend Testing: Jest + Supertest for overdue accounts API testing
- Integration testing for dashboard widget updates and quick actions

## Testing
[Source: architecture/testing-strategy.md]
- Test file location: `src/__tests__/components/business/dashboard/OverdueAccountsWidget.test.tsx`
- Test standards: Jest + Testing Library for React components, Jest + Supertest for API testing
- Testing frameworks: Jest 29+ and Testing Library 13+ with TypeScript support
- Specific requirements: Test overdue calculations, quick action functionality, role-based visibility, real-time updates, and responsive design

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-01-16 | 1.0 | Initial story creation for due date alert dashboard display | Bob (Scrum Master) |

## Dev Agent Record

### Agent Model Used
*This section will be populated by the development agent during implementation*

### Debug Log References
*This section will be populated by the development agent during implementation*

### Completion Notes
*This section will be populated by the development agent during implementation*

### File List
*This section will be populated by the development agent during implementation*

## QA Results
*This section will be populated by the QA agent during review*